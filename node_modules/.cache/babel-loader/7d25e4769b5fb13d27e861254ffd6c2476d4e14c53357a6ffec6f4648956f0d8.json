{"ast":null,"code":"import _slicedToArray from\"/home/lino/Documents/projects/business-sector-test-task/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from'react';import{useAppDispatch,useAppSelector}from'../hooks/storeHooks';import{Post}from'./Post';import{TableHeaderTitle}from'./TableHeaderTitle';import{config}from'../config.d';import{useParams}from'react-router-dom';import{filterPostsBy}from'../lib/filterPostsBy';import{sortPosts}from'../store/posts';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export function Table(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),activeTableHeaderTitleIcon=_useState2[0],setActiveTableHeaderTitleIcon=_useState2[1];var dispatch=useAppDispatch();var _useState3=useState(config.defaultSortKey),_useState4=_slicedToArray(_useState3,2),sortBy=_useState4[0],setSortBy=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),shownPosts=_useState6[0],setShownPosts=_useState6[1];var _useAppSelector=useAppSelector(function(state){return[state.posts.posts,state.searchString.searchString];}),_useAppSelector2=_slicedToArray(_useAppSelector,2),posts=_useAppSelector2[0],searchString=_useAppSelector2[1];var postPageCount=useParams().postPageCount||0;var tableHeaderKeyTitlePairs=[{key:'id',title:'ID'},{key:'title',title:'Заголовок'},{key:'body',title:'Описание'}];useEffect(function(){var startIdx=(+postPageCount-1)*config.maxPostsQuantity;var quantity=+postPageCount*config.maxPostsQuantity;setShownPosts(posts.filter(function(post){return filterPostsBy(post,searchString.trim());}).slice(startIdx,quantity));},[postPageCount,posts,searchString]);useEffect(function(){dispatch(sortPosts(sortBy));},[sortBy]);return/*#__PURE__*/_jsxs(\"table\",{className:\"w-full table-fixed\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-[#474955] text-white w-full\",children:/*#__PURE__*/_jsx(\"tr\",{className:\"w-11/12 md:w-full\",children:tableHeaderKeyTitlePairs.length&&tableHeaderKeyTitlePairs.map(function(keyTitlePair,idx){return/*#__PURE__*/_jsx(TableHeaderTitle,{activeIcon:activeTableHeaderTitleIcon,setActiveIcon:setActiveTableHeaderTitleIcon,setSortBy:setSortBy,keyTitlePair:keyTitlePair},idx);})})}),/*#__PURE__*/_jsx(\"tbody\",{children:shownPosts.length&&shownPosts.map(function(post,idx){return/*#__PURE__*/_jsx(Post,{post:post},idx);})})]});}","map":{"version":3,"names":["useEffect","useState","useAppDispatch","useAppSelector","Post","TableHeaderTitle","config","useParams","filterPostsBy","sortPosts","jsx","_jsx","jsxs","_jsxs","Table","_useState","_useState2","_slicedToArray","activeTableHeaderTitleIcon","setActiveTableHeaderTitleIcon","dispatch","_useState3","defaultSortKey","_useState4","sortBy","setSortBy","_useState5","_useState6","shownPosts","setShownPosts","_useAppSelector","state","posts","searchString","_useAppSelector2","postPageCount","tableHeaderKeyTitlePairs","key","title","startIdx","maxPostsQuantity","quantity","filter","post","trim","slice","className","children","length","map","keyTitlePair","idx","activeIcon","setActiveIcon"],"sources":["/home/lino/Documents/projects/business-sector-test-task/src/components/Table.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useAppDispatch, useAppSelector } from '../hooks/storeHooks';\nimport { RootState } from '../store';\nimport { IPost, KeysMatching } from '../types';\nimport { Post } from './Post';\nimport { TableHeaderTitle } from './TableHeaderTitle';\n\nimport { config } from '../config.d';\nimport { useParams } from 'react-router-dom';\nimport { filterPostsBy } from '../lib/filterPostsBy';\nimport { sortPosts } from '../store/posts';\n\n\nexport function Table() {\n  const [activeTableHeaderTitleIcon, setActiveTableHeaderTitleIcon] = useState<string>('');\n  const dispatch = useAppDispatch();\n  const [sortBy, setSortBy] = useState<string>(config.defaultSortKey);\n  const [shownPosts, setShownPosts] = useState<IPost[]>([]);\n  const [posts, searchString] = useAppSelector((state: RootState) => [state.posts.posts, state.searchString.searchString]);\n  const postPageCount = useParams().postPageCount || 0;\n  const tableHeaderKeyTitlePairs: { key: string, title: string }[] = [\n    {\n      key: 'id',\n      title: 'ID'\n    },\n    {\n      key: 'title',\n      title: 'Заголовок'\n    },\n    {\n      key: 'body',\n      title: 'Описание'\n    },\n  ];\n\n  useEffect(() => {\n    const startIdx = (+postPageCount - 1) * config.maxPostsQuantity;\n    const quantity = +postPageCount * config.maxPostsQuantity;\n\n    setShownPosts(posts\n      .filter(post => filterPostsBy(post, searchString.trim()))\n      .slice(startIdx, quantity));\n\n  }, [postPageCount, posts, searchString]);\n\n  useEffect(() => {\n    dispatch(sortPosts(sortBy as KeysMatching<IPost, string>));\n  }, [sortBy]);\n\n  return (\n    <table className=\"w-full table-fixed\">\n      <thead className='bg-[#474955] text-white w-full'>\n        <tr className='w-11/12 md:w-full'>\n          {\n            tableHeaderKeyTitlePairs.length && tableHeaderKeyTitlePairs.map((keyTitlePair, idx) => {\n              return <TableHeaderTitle\n                activeIcon={activeTableHeaderTitleIcon}\n                setActiveIcon={setActiveTableHeaderTitleIcon}\n                setSortBy={setSortBy}\n                keyTitlePair={keyTitlePair}\n                key={idx}\n              />;\n            })\n          }\n        </tr>\n      </thead>\n      <tbody>\n        {\n          shownPosts.length && shownPosts.map((post, idx) => {\n            return <Post post={post} key={idx} />\n          })\n        }\n      </tbody>\n    </table>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}